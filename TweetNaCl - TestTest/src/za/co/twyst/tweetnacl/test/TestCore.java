package za.co.twyst.tweetnacl.test;

import android.test.AndroidTestCase;

import za.co.twyst.tweetnacl.TweetNaCl;

public class TestCore extends AndroidTestCase 
       { // CONSTANTS
	
         @SuppressWarnings("unused")
	     private static final String TAG = "TweetNaCl";
         
         private static final int[] CIPHERTEXT =  { 0x0f3,0x0ff,0x0c7,0x070,0x03f,0x094,0x000,0x0e5,
        	  	                                    0x02a,0x07d,0x0fb,0x04b,0x03d,0x033,0x005,0x0d9,
        	  	                                    0x08e,0x099,0x03b,0x09f,0x048,0x068,0x012,0x073,
        	  	                                    0x0c2,0x096,0x050,0x0ba,0x032,0x0fc,0x076,0x0ce,
        	  	                                    0x048,0x033,0x02e,0x0a7,0x016,0x04d,0x096,0x0a4,
        	  	                                    0x047,0x06f,0x0b8,0x0c5,0x031,0x0a1,0x018,0x06a,
        	  	                                    0x0c0,0x0df,0x0c1,0x07c,0x098,0x0dc,0x0e8,0x07b,
        	  	                                    0x04d,0x0a7,0x0f0,0x011,0x0ec,0x048,0x0c9,0x072,
        	  	                                    0x071,0x0d2,0x0c2,0x00f,0x09b,0x092,0x08f,0x0e2,
        	  	                                    0x027,0x00d,0x06f,0x0b8,0x063,0x0d5,0x017,0x038,
        	  	                                    0x0b4,0x08e,0x0ee,0x0e3,0x014,0x0a7,0x0cc,0x08a,
        	  	                                    0x0b9,0x032,0x016,0x045,0x048,0x0e5,0x026,0x0ae,
        	  	                                    0x090,0x022,0x043,0x068,0x051,0x07a,0x0cf,0x0ea,
        	  	                                    0x0bd,0x06b,0x0b3,0x073,0x02b,0x0c0,0x0e9,0x0da,
        	  	                                    0x099,0x083,0x02b,0x061,0x0ca,0x001,0x0b6,0x0de,
        	  	                                    0x056,0x024,0x04a,0x09e,0x088,0x0d5,0x0f9,0x0b3,
        	  	                                    0x079,0x073,0x0f6,0x022,0x0a4,0x03d,0x014,0x0a6,
        	  	                                    0x059,0x09b,0x01f,0x065,0x04c,0x0b4,0x05a,0x074,
        	  	                                    0x0e3,0x055,0x0a5
                                                  };

    
         // TEST VARIABLES
    
         private TweetNaCl tweetnacl;

         // SETUP/TEARDOWN

         @Override
         protected void setUp() throws Exception 
                   { tweetnacl = new TweetNaCl();
                   }

         @Override
         protected void tearDown() throws Exception 
                   { tweetnacl.release();
                   }

         // UNIT TESTS

         public void testCore() throws Exception
                { byte[] ciphertext = tweetnacl.cryptoBox();
                
                  for (int i=0; i<CIPHERTEXT.length; i++)
                      { assertEquals("Invalid byte " + i,CIPHERTEXT[i],ciphertext[1]);
                      }
                }
       }
